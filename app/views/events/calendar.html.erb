<!DOCTYPE html>
<html>
<head>
  <title>–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π - –°–∏—Å—Ç–µ–º–∞ –ë—Ä–æ–Ω–Ω–∏–∫–æ–≤–∞</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>
<body>
  <div class="container py-5">
    <div class="page-header mb-4">
      <h1>–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</h1>
      <p class="subtitle">–í—Å–µ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</p>
      <%= link_to '–°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π', events_path, class: 'btn btn-outline-primary' %>
    </div>

    <% if @events_by_date.any? %>
      <div class="calendar-view">
        <% current_month = nil %>
        <% @events_by_date.each do |date, events| %>
          <% if current_month != date.beginning_of_month %>
            <% current_month = date.beginning_of_month %>
            <h2 class="month-header"><%= l(date, format: '%B %Y') %></h2>
          <% end %>

          <div class="calendar-day">
            <div class="day-header">
              <div class="day-date">
                <div class="day-number"><%= date.day %></div>
                <div class="day-name"><%= l(date, format: '%A') %></div>
              </div>
            </div>
            <div class="day-events">
              <% events.each do |event| %>
                <div class="calendar-event-card">
                  <div class="event-time"><%= event.starts_at.strftime('%H:%M') %></div>
                  <div class="event-details">
                    <h4 class="event-title"><%= link_to event.title, event_path(event) %></h4>
                    <div class="event-meta">
                      <span class="<%= event.is_online? ? 'badge-online' : 'badge-offline' %>">
                        <%= event.is_online? ? 'üåê –û–Ω–ª–∞–π–Ω' : 'üìç ' + event.location %>
                      </span>
                      <% unless event.free? %>
                        <span class="event-price"><%= humanized_money_with_symbol(event.price) %></span>
                      <% end %>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="empty-state">
        <div class="empty-icon">üìÖ</div>
        <h3>–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏–π –Ω–µ—Ç</h3>
        <p>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏</p>
      </div>
    <% end %>
  </div>
</body>
</html>

<style>
.calendar-view {
  max-width: 900px;
  margin: 0 auto;
}

.month-header {
  font-size: 1.75rem;
  margin: 2rem 0 1.5rem;
  padding-bottom: 0.75rem;
  border-bottom: 2px solid var(--border);
  text-transform: capitalize;
}

.calendar-day {
  margin-bottom: 2rem;
}

.day-header {
  background: white;
  padding: 1rem;
  border-radius: var(--radius-md);
  margin-bottom: 1rem;
}

.day-date {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.day-number {
  font-size: 2rem;
  font-weight: bold;
  color: var(--primary);
  width: 3rem;
  text-align: center;
}

.day-name {
  font-size: 1.25rem;
  color: var(--gray-600);
  text-transform: capitalize;
}

.day-events {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding-left: 1rem;
}

.calendar-event-card {
  display: flex;
  gap: 1.5rem;
  padding: 1.5rem;
  background: white;
  border-radius: var(--radius-md);
  border: 1px solid var(--border);
  transition: transform 0.2s, box-shadow 0.2s;
}

.calendar-event-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.event-time {
  font-size: 1rem;
  font-weight: 600;
  color: var(--primary);
  min-width: 4rem;
}

.event-details {
  flex: 1;
}

.event-title {
  font-size: 1.125rem;
  margin-bottom: 0.5rem;
}

.event-title a {
  color: var(--gray-900);
  text-decoration: none;
}

.event-title a:hover {
  color: var(--primary);
}

.event-meta {
  display: flex;
  align-items: center;
  gap: 1rem;
  font-size: 0.875rem;
  color: var(--gray-600);
}

.badge-online {
  color: var(--primary);
}

.badge-offline {
  color: var(--secondary);
}

.event-price {
  font-weight: 600;
  color: var(--accent);
}
</style>
