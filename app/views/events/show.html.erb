<!DOCTYPE html>
<html>
<head>
  <title><%= @event.title %> - –°–∏—Å—Ç–µ–º–∞ –ë—Ä–æ–Ω–Ω–∏–∫–æ–≤–∞</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>
<body>
  <div class="container py-5">
    <%= link_to '‚Üê –í—Å–µ —Å–æ–±—ã—Ç–∏—è', events_path, class: 'btn btn-link mb-3' %>

    <div class="row">
      <div class="col-lg-8">
        <div class="card glass-effect">
          <div class="card-body">
            <div class="event-header mb-4">
              <% if @event.is_online? %>
                <span class="badge badge-online">–û–Ω–ª–∞–π–Ω</span>
              <% else %>
                <span class="badge badge-offline">–û—Ñ–ª–∞–π–Ω</span>
              <% end %>
              <% unless @event.free? %>
                <h2 class="event-price mb-0"><%= humanized_money_with_symbol(@event.price) %></h2>
              <% else %>
                <span class="badge badge-free badge-lg">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
              <% end %>
            </div>

            <h1 class="event-title mb-4"><%= @event.title %></h1>

            <div class="event-details mb-4">
              <div class="detail-item">
                <span class="detail-icon">üìÖ</span>
                <div>
                  <div class="detail-label">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</div>
                  <div class="detail-value"><%= @event.starts_at.strftime('%d %B %Y –≤ %H:%M') %></div>
                  <% if @event.ends_at %>
                    <div class="detail-value text-muted">–û–∫–æ–Ω—á–∞–Ω–∏–µ: <%= @event.ends_at.strftime('%d %B %Y –≤ %H:%M') %></div>
                  <% end %>
                </div>
              </div>

              <div class="detail-item">
                <span class="detail-icon">üìç</span>
                <div>
                  <div class="detail-label">–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è</div>
                  <div class="detail-value"><%= @event.format_location %></div>
                </div>
              </div>

              <% if @event.max_participants %>
                <div class="detail-item">
                  <span class="detail-icon">üë•</span>
                  <div>
                    <div class="detail-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç</div>
                    <div class="detail-value">
                      –î–æ—Å—Ç—É–ø–Ω–æ: <%= @event.available_spots %> –∏–∑ <%= @event.max_participants %>
                    </div>
                  </div>
                </div>
              <% end %>

              <% if @event.organizer %>
                <div class="detail-item">
                  <span class="detail-icon">üë§</span>
                  <div>
                    <div class="detail-label">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</div>
                    <div class="detail-value"><%= @event.organizer.full_name %></div>
                  </div>
                </div>
              <% end %>
            </div>

            <% if @event.description.present? %>
              <div class="event-description">
                <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                <%= simple_format(@event.description) %>
              </div>
            <% end %>
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card glass-effect sticky-top" style="top: 2rem;">
          <div class="card-body">
            <% if current_user %>
              <% if @registration %>
                <div class="alert alert-info">
                  <strong>–í—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã</strong><br>
                  –°—Ç–∞—Ç—É—Å: <%= @registration.status.humanize %>
                </div>
                <% if @registration.status_pending? || @registration.status_confirmed? %>
                  <%= button_to '–û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é', event_registration_path(@registration), method: :delete, class: 'btn btn-outline-danger w-100', data: { confirm: '–í—ã —É–≤–µ—Ä–µ–Ω—ã?' } %>
                <% end %>
              <% elsif @event.full? %>
                <div class="alert alert-warning">
                  <strong>–í—Å–µ –º–µ—Å—Ç–∞ –∑–∞–Ω—è—Ç—ã</strong>
                </div>
              <% elsif @event.past? %>
                <div class="alert alert-secondary">
                  <strong>–°–æ–±—ã—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</strong>
                </div>
              <% else %>
                <%= button_to '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è', event_event_registrations_path(@event), class: 'btn btn-primary w-100 btn-lg' %>
                <% unless @event.free? %>
                  <p class="text-muted text-center mt-2 small">–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å —É—á–∞—Å—Ç–∏–µ</p>
                <% end %>
              <% end %>
            <% else %>
              <p class="text-muted text-center">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</p>
              <%= link_to '–í–æ–π—Ç–∏', login_path, class: 'btn btn-primary w-100' %>
            <% end %>

            <hr>

            <div class="quick-info">
              <div class="quick-info-item">
                <span class="label">–§–æ—Ä–º–∞—Ç:</span>
                <span class="value"><%= @event.is_online? ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ–ª–∞–π–Ω' %></span>
              </div>
              <div class="quick-info-item">
                <span class="label">–¶–µ–Ω–∞:</span>
                <span class="value"><%= @event.free? ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : humanized_money_with_symbol(@event.price) %></span>
              </div>
              <% if @event.category %>
                <div class="quick-info-item">
                  <span class="label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</span>
                  <span class="value"><%= @event.category.name %></span>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>

<style>
.event-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.event-title {
  font-size: 2rem;
}

.event-details {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.detail-item {
  display: flex;
  gap: 1rem;
}

.detail-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.detail-label {
  font-size: 0.875rem;
  color: var(--gray-600);
  margin-bottom: 0.25rem;
}

.detail-value {
  font-weight: 500;
}

.event-description {
  margin-top: 2rem;
  padding-top: 2rem;
  border-top: 1px solid var(--border);
}

.quick-info {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.quick-info-item {
  display: flex;
  justify-content: space-between;
}

.quick-info-item .label {
  color: var(--gray-600);
  font-size: 0.875rem;
}

.quick-info-item .value {
  font-weight: 600;
}
</style>
