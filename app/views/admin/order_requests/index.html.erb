<% content_for :title, "–ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å" %>

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-8);">
  <h1 style="font-size: 1.875rem; font-weight: 700; color: var(--gray-900);">üìã –ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É</h1>
  <span class="badge badge-primary" style="font-size: 1.125rem; padding: var(--space-2) var(--space-4);">
    <%= @order_requests.total_count %> –æ–∂–∏–¥–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è
  </span>
</div>

<% if @order_requests.any? %>
  <div class="card">
    <table class="admin-table">
      <thead>
        <tr>
          <th>–ù–æ–º–µ—Ä –∑–∞—è–≤–∫–∏</th>
          <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
          <th>–ü—Ä–æ–¥—É–∫—Ç</th>
          <th>–°—É–º–º–∞</th>
          <th>–ë–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞</th>
          <th>–î–∞—Ç–∞</th>
          <th style="text-align: center;">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
      </thead>
      <tbody>
        <% @order_requests.each do |request| %>
          <tr>
            <td>
              <span style="font-weight: 600; font-family: var(--font-mono);">
                <%= request.request_number %>
              </span>
            </td>
            <td>
              <div style="font-weight: 600; color: var(--gray-900);"><%= request.user.full_name %></div>
              <div style="font-size: 0.875rem; color: var(--gray-600);"><%= request.user.email %></div>
            </td>
            <td>
              <div style="display: flex; align-items: center; gap: var(--space-3);">
                <span style="font-size: 2rem;"><%= product_icon(request.product.product_type) %></span>
                <div>
                  <div style="font-weight: 600; color: var(--gray-900);"><%= request.product.name %></div>
                  <div style="font-size: 0.875rem; color: var(--gray-600);"><%= product_type_label(request.product.product_type) %></div>
                </div>
              </div>
            </td>
            <td>
              <span style="font-weight: 700; color: var(--primary);">
                <%= humanized_money_with_symbol(request.total) %>
              </span>
            </td>
            <td>
              <% wallet_balance = request.user.wallet.balance_kopecks %>
              <% sufficient = wallet_balance >= request.total_kopecks %>
              <div style="font-weight: 600; color: <%= sufficient ? 'var(--color-success)' : 'var(--color-error)' %>;">
                <%= humanized_money_with_symbol(Money.new(wallet_balance, 'RUB')) %>
              </div>
              <div style="font-size: 0.75rem; color: var(--gray-600);">
                <%= sufficient ? '‚úì –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ' : '‚úó –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ' %>
              </div>
            </td>
            <td style="color: var(--gray-600); font-size: 0.875rem;">
              <%= l(request.created_at, format: :short) %>
            </td>
            <td style="text-align: center;">
              <%= link_to "–ü–æ–¥—Ä–æ–±–Ω–µ–µ", admin_order_request_path(request), class: "btn btn-primary btn-sm" %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <%= paginate @order_requests %>
<% else %>
  <div class="card" style="text-align: center; padding: var(--space-12);">
    <div style="font-size: 4rem; margin-bottom: var(--space-4);">‚úì</div>
    <h3 style="margin-bottom: var(--space-2);">–ù–µ—Ç –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞—è–≤–æ–∫</h3>
    <p style="color: var(--gray-600);">–í—Å–µ –∑–∞—è–≤–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã</p>
  </div>
<% end %>
