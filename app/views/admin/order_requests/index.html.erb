<% content_for :title, "–ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å" %>

<div style="padding: 2rem;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <h1 class="text-gradient">üìã –ó–∞—è–≤–∫–∏ –Ω–∞ –ø–æ–∫—É–ø–∫—É</h1>
    <span class="badge badge-primary" style="font-size: 1.125rem; padding: 0.5rem 1rem;">
      <%= @order_requests.total_count %> –æ–∂–∏–¥–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è
    </span>
  </div>

  <% if @order_requests.any? %>
    <div class="card">
      <div style="overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 2px solid var(--gray-200); text-align: left;">
              <th style="padding: 1rem; font-weight: 600;">–ù–æ–º–µ—Ä –∑–∞—è–≤–∫–∏</th>
              <th style="padding: 1rem; font-weight: 600;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
              <th style="padding: 1rem; font-weight: 600;">–ü—Ä–æ–¥—É–∫—Ç</th>
              <th style="padding: 1rem; font-weight: 600;">–°—É–º–º–∞</th>
              <th style="padding: 1rem; font-weight: 600;">–ë–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞</th>
              <th style="padding: 1rem; font-weight: 600;">–î–∞—Ç–∞</th>
              <th style="padding: 1rem; font-weight: 600; text-align: center;">–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            <% @order_requests.each do |request| %>
              <tr style="border-bottom: 1px solid var(--gray-100); transition: background-color 0.2s ease;"
                  onmouseover="this.style.backgroundColor='var(--gray-50)'"
                  onmouseout="this.style.backgroundColor=''">
                <td style="padding: 1rem;">
                  <span style="font-weight: 600; font-family: monospace;">
                    <%= request.request_number %>
                  </span>
                </td>
                <td style="padding: 1rem;">
                  <div>
                    <div style="font-weight: 600; margin-bottom: 0.25rem;">
                      <%= request.user.full_name %>
                    </div>
                    <div style="font-size: 0.875rem; color: var(--gray-600);">
                      <%= request.user.email %>
                    </div>
                  </div>
                </td>
                <td style="padding: 1rem;">
                  <div style="display: flex; align-items: center; gap: 0.75rem;">
                    <span style="font-size: 2rem;"><%= product_icon(request.product.product_type) %></span>
                    <div>
                      <div style="font-weight: 600; margin-bottom: 0.25rem;">
                        <%= request.product.name %>
                      </div>
                      <div style="font-size: 0.875rem; color: var(--gray-600);">
                        <%= product_type_label(request.product.product_type) %>
                      </div>
                    </div>
                  </div>
                </td>
                <td style="padding: 1rem;">
                  <span style="font-weight: 700; color: var(--primary);">
                    <%= humanized_money_with_symbol(request.total) %>
                  </span>
                </td>
                <td style="padding: 1rem;">
                  <% wallet_balance = request.user.wallet.balance_kopecks %>
                  <% sufficient = wallet_balance >= request.total_kopecks %>
                  <div>
                    <div style="font-weight: 600; color: <%= sufficient ? 'var(--color-success)' : 'var(--color-error)' %>;">
                      <%= humanized_money_with_symbol(Money.new(wallet_balance, 'RUB')) %>
                    </div>
                    <div style="font-size: 0.75rem; color: var(--gray-600);">
                      <%= sufficient ? '‚úì –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ' : '‚úó –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ' %>
                    </div>
                  </div>
                </td>
                <td style="padding: 1rem;">
                  <div style="font-size: 0.875rem; color: var(--gray-600);">
                    <%= l(request.created_at, format: :short) %>
                  </div>
                </td>
                <td style="padding: 1rem; text-align: center;">
                  <%= link_to "–ü–æ–¥—Ä–æ–±–Ω–µ–µ",
                              admin_order_request_path(request),
                              class: "btn btn-primary btn-sm" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <%= paginate @order_requests %>
  <% else %>
    <div class="card" style="text-align: center; padding: 3rem;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">‚úì</div>
      <h3 style="margin-bottom: 0.5rem;">–ù–µ—Ç –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞—è–≤–æ–∫</h3>
      <p style="color: var(--gray-600);">
        –í—Å–µ –∑–∞—è–≤–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
      </p>
    </div>
  <% end %>
</div>
