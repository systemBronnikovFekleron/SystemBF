<% content_for :title, "–°–æ–∑–¥–∞—Ç—å Email –®–∞–±–ª–æ–Ω" %>

<div style="display: flex; gap: var(--space-6);">
  <!-- Main Form -->
  <div style="flex: 1; max-width: 900px;">
    <%= link_to admin_email_templates_path, style: "display: inline-flex; align-items: center; gap: var(--space-2); color: var(--gray-600); text-decoration: none; font-size: 0.875rem; margin-bottom: var(--space-3);" do %>
      ‚Üê –í—Å–µ —à–∞–±–ª–æ–Ω—ã
    <% end %>

    <h1 style="font-size: 2rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-8);">
      –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —à–∞–±–ª–æ–Ω
    </h1>

    <%= form_with model: @email_template, url: admin_email_templates_path do |f| %>
      <!-- Basic Info -->
      <div style="background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: var(--space-6);">
        <h2 style="font-size: 1.25rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-6);">
          –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        </h2>

        <div style="margin-bottom: var(--space-5);">
          <%= f.label :template_key, '–ö–ª—é—á —à–∞–±–ª–æ–Ω–∞', style: "display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);" %>
          <%= f.text_field :template_key, placeholder: 'welcome_email', style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem; font-family: monospace;" %>
          <p style="font-size: 0.75rem; color: var(--gray-600); margin-top: var(--space-2);">
            –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (—Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω–∏—Ü–∞, —Ü–∏—Ñ—Ä—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è)
          </p>
        </div>

        <div style="margin-bottom: var(--space-5);">
          <%= f.label :name, '–ù–∞–∑–≤–∞–Ω–∏–µ', style: "display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);" %>
          <%= f.text_field :name, placeholder: '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–∏—Å—å–º–æ', style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem;" %>
        </div>

        <div style="margin-bottom: var(--space-5);">
          <%= f.label :category, '–ö–∞—Ç–µ–≥–æ—Ä–∏—è', style: "display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);" %>
          <%= f.select :category,
              options_for_select([['–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏', 'user'], ['–ó–∞–∫–∞–∑—ã', 'order'], ['–ü—Ä–æ–¥—É–∫—Ç—ã', 'product'], ['–°–∏—Å—Ç–µ–º–∞', 'system']]),
              { include_blank: '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏' },
              style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem;" %>
        </div>

        <div style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-4); background: rgba(79, 70, 229, 0.05); border-radius: var(--radius-md);">
          <%= f.check_box :active, checked: true, style: "width: 20px; height: 20px; cursor: pointer;" %>
          <%= f.label :active, '–®–∞–±–ª–æ–Ω –∞–∫—Ç–∏–≤–µ–Ω (–≤–∫–ª—é—á–∏—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è)', style: "font-weight: 600; color: var(--primary-dark); cursor: pointer;" %>
        </div>
      </div>

      <!-- Subject -->
      <div style="background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: var(--space-6);">
        <h2 style="font-size: 1.25rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-2);">
          –¢–µ–º–∞ –ø–∏—Å—å–º–∞
        </h2>
        <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: var(--space-4);">
          –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ <code style="background: var(--gray-100); padding: 2px 6px; border-radius: 4px;">{{–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è}}</code>
        </p>

        <%= f.text_field :subject, placeholder: '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{user_name}}!', style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem;" %>
      </div>

      <!-- Body HTML -->
      <div style="background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: var(--space-6);">
        <h2 style="font-size: 1.25rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-2);">
          HTML –≤–µ—Ä—Å–∏—è
        </h2>
        <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: var(--space-4);">
          –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø–∏—Å—å–º–∞ –≤ HTML —Ñ–æ—Ä–º–∞—Ç–µ
        </p>

        <%= f.text_area :body_html, rows: 15, placeholder: '<h1>–ü—Ä–∏–≤–µ—Ç, {{user_name}}!</h1><p>–†–∞–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –≤ –°–∏—Å—Ç–µ–º–µ –ë—Ä–æ–Ω–Ω–∏–∫–æ–≤–∞.</p>', style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 0.875rem; font-family: monospace; resize: vertical;" %>
      </div>

      <!-- Body Text -->
      <div style="background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: var(--space-6);">
        <h2 style="font-size: 1.25rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-2);">
          –¢–µ–∫—Å—Ç–æ–≤–∞—è –≤–µ—Ä—Å–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        </h2>
        <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: var(--space-4);">
          –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –ø–æ—á—Ç–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ HTML
        </p>

        <%= f.text_area :body_text, rows: 10, placeholder: '–ü—Ä–∏–≤–µ—Ç, {{user_name}}!\n\n–†–∞–¥—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –≤ –°–∏—Å—Ç–µ–º–µ –ë—Ä–æ–Ω–Ω–∏–∫–æ–≤–∞.', style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 0.875rem; font-family: monospace; resize: vertical;" %>
      </div>

      <!-- Actions -->
      <div style="display: flex; gap: var(--space-3); justify-content: flex-end;">
        <%= link_to '–û—Ç–º–µ–Ω–∞', admin_email_templates_path, style: "padding: var(--space-3) var(--space-6); background: white; border: 2px solid var(--gray-300); color: var(--gray-700); border-radius: var(--radius-md); text-decoration: none; font-weight: 600;" %>
        <%= f.submit '–°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω', style: "padding: var(--space-3) var(--space-6); background: var(--primary); color: white; border: none; border-radius: var(--radius-md); font-weight: 600; cursor: pointer;" %>
      </div>
    <% end %>
  </div>

  <!-- Sidebar: Variables -->
  <div style="width: 300px; flex-shrink: 0;">
    <div style="position: sticky; top: var(--space-6);">
      <div style="background: white; border-radius: var(--radius-xl); padding: var(--space-6); box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
        <h3 style="font-size: 1.125rem; font-weight: 700; color: var(--gray-900); margin-bottom: var(--space-4);">
          üí° –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        </h3>

        <div style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: var(--space-4);">
          –ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å:
        </div>

        <div style="display: flex; flex-direction: column; gap: var(--space-2);">
          <% common_variables = ['user_name', 'user_email', 'order_number', 'product_name', 'price', 'date', 'url', 'company_name'] %>
          <% common_variables.each do |var| %>
            <button type="button" onclick="navigator.clipboard.writeText('{{<%= var %>}}'); this.textContent='‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!'; setTimeout(() => this.textContent='{{<%= var %>}}', 1500);" style="padding: var(--space-2) var(--space-3); background: rgba(79, 70, 229, 0.05); border: 1px solid rgba(79, 70, 229, 0.15); border-radius: var(--radius-md); text-align: left; cursor: pointer; font-family: monospace; font-size: 0.75rem; color: var(--primary-dark); transition: all 0.2s;" onmouseover="this.style.background='rgba(79, 70, 229, 0.1)';" onmouseout="this.style.background='rgba(79, 70, 229, 0.05)';">
              {{<%= var %>}}
            </button>
          <% end %>
        </div>

        <div style="margin-top: var(--space-6); padding: var(--space-4); background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: var(--radius-md);">
          <div style="font-size: 0.75rem; color: #92400e; line-height: 1.5;">
            <strong>–°–æ–≤–µ—Ç:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, <code>user_first_name</code> –≤–º–µ—Å—Ç–æ <code>fname</code>.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
