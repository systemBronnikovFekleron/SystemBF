<div style="padding: 2rem; max-width: 900px; margin: 0 auto;">
  <%= link_to '← Назад к списку', admin_diagnostics_path, style: 'color: var(--primary); margin-bottom: 2rem; display: block;' %>

  <div style="display: flex; justify-content: space-between; margin-bottom: 2rem;">
    <div>
      <h1 style="font-size: 2rem; font-weight: 700;"><%= @diagnostic.display_name %></h1>
      <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
        <% if @diagnostic.status_scheduled? %>
          <span class="badge badge-warning">Запланировано</span>
        <% elsif @diagnostic.status_completed? %>
          <span class="badge badge-success">Проведено</span>
        <% elsif @diagnostic.status_cancelled? %>
          <span class="badge badge-error">Отменено</span>
        <% end %>
        <% if @diagnostic.score.present? %>
          <span class="badge badge-primary">Балл: <%= @diagnostic.score %></span>
        <% end %>
      </div>
    </div>
    <div style="display: flex; gap: 0.75rem;">
      <%= link_to 'Изменить', edit_admin_diagnostic_path(@diagnostic), class: 'btn btn-primary' %>
      <%= button_to 'Удалить', admin_diagnostic_path(@diagnostic), method: :delete,
          data: { turbo_confirm: 'Вы уверены?' }, class: 'btn btn-outline btn-danger' %>
    </div>
  </div>

  <!-- User Info -->
  <div class="card" style="padding: 2rem; margin-bottom: 1.5rem;">
    <h3 style="font-weight: 600; margin-bottom: 1rem;">Информация о пользователе</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
      <div>
        <strong>ФИО:</strong>
        <%= link_to @user.full_name, admin_user_path(@user), style: 'color: var(--primary);' %>
      </div>
      <div><strong>Email:</strong> <%= @user.email %></div>
      <div><strong>Телефон:</strong> <%= @user.profile&.phone || 'Не указан' %></div>
      <div><strong>Классификация:</strong> <%= @user.classification.humanize %></div>
    </div>
  </div>

  <!-- Diagnostic Details -->
  <div class="card" style="padding: 2rem; margin-bottom: 1.5rem;">
    <h3 style="font-weight: 600; margin-bottom: 1rem;">Детали диагностики</h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.875rem;">
      <div>
        <strong>Тип:</strong>
        <% case @diagnostic.diagnostic_type %>
        <% when 'vision' %>
          Диагностика: Видение
        <% when 'bioenergy' %>
          Диагностика: Биоэнергетика
        <% when 'psychobiocomputer' %>
          Диагностика: Психобиокомпьютер
        <% else %>
          <%= @diagnostic.diagnostic_type %>
        <% end %>
      </div>
      <div>
        <strong>Дата проведения:</strong>
        <%= @diagnostic.conducted_at.present? ? l(@diagnostic.conducted_at, format: :long) : 'Не назначена' %>
      </div>
      <div>
        <strong>Специалист:</strong>
        <% if @diagnostic.conducted_by.present? %>
          <%= link_to @diagnostic.conducted_by.full_name, admin_user_path(@diagnostic.conducted_by), style: 'color: var(--primary);' %>
        <% else %>
          Не назначен
        <% end %>
      </div>
      <div>
        <strong>Создано:</strong>
        <%= l(@diagnostic.created_at, format: :long) %>
      </div>
    </div>
  </div>

  <!-- Results -->
  <% if @diagnostic.results.present? %>
    <div class="card" style="padding: 2rem; margin-bottom: 1.5rem;">
      <h3 style="font-weight: 600; margin-bottom: 1rem;">Результаты</h3>
      <div style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-md);">
        <%= simple_format(@diagnostic.results) %>
      </div>
    </div>
  <% end %>

  <!-- Recommendations -->
  <% if @diagnostic.recommendations.present? %>
    <div class="card" style="padding: 2rem; margin-bottom: 1.5rem;">
      <h3 style="font-weight: 600; margin-bottom: 1rem;">Рекомендации</h3>
      <div style="background: var(--gray-50); padding: 1rem; border-radius: var(--radius-md);">
        <%= simple_format(@diagnostic.recommendations) %>
      </div>
    </div>
  <% end %>
</div>
