<% credentials = integration.credentials_hash %>

<div style="margin-bottom: var(--space-5);">
  <%= label_tag 'integration_setting[credentials][measurement_id]', 'Measurement ID (GA4)', style: "display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);" %>
  <%= text_field_tag 'integration_setting[credentials][measurement_id]', credentials[:measurement_id],
      placeholder: 'G-XXXXXXXXXX',
      style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem; font-family: monospace;" %>
  <p style="font-size: 0.75rem; color: var(--gray-600); margin-top: var(--space-2);">
    Найти в: Google Analytics → Admin → Data Streams → выберите поток → Measurement ID
  </p>
</div>

<div style="margin-bottom: var(--space-5);">
  <%= label_tag 'integration_setting[credentials][api_secret]', 'API Secret (для Measurement Protocol)', style: "display: block; font-weight: 600; color: var(--gray-700); margin-bottom: var(--space-2);" %>
  <%= text_field_tag 'integration_setting[credentials][api_secret]', credentials[:api_secret],
      placeholder: 'Опционально - для server-side tracking',
      style: "width: 100%; padding: var(--space-3); border: 2px solid var(--gray-200); border-radius: var(--radius-md); font-size: 1rem; font-family: monospace;" %>
  <% if credentials[:api_secret].present? %>
    <p style="font-size: 0.75rem; color: var(--gray-600); margin-top: var(--space-2);">
      Текущий secret: <%= integration.masked_credentials[:api_secret] %>
    </p>
  <% end %>
  <p style="font-size: 0.75rem; color: var(--gray-600); margin-top: var(--space-2);">
    Найти в: Google Analytics → Admin → Data Streams → Measurement Protocol API secrets
  </p>
</div>

<div style="padding: var(--space-4); background: rgba(79, 70, 229, 0.05); border-left: 4px solid var(--primary); border-radius: var(--radius-md);">
  <div style="display: flex; gap: var(--space-3);">
    <div style="font-size: 1.25rem;">ℹ️</div>
    <div style="font-size: 0.875rem; color: var(--primary-dark);">
      <strong>Как это работает:</strong><br>
      После сохранения, скрипт отслеживания GA4 будет автоматически добавлен на все страницы сайта.
      API Secret требуется только для отправки событий с сервера (server-side tracking).
    </div>
  </div>
</div>
