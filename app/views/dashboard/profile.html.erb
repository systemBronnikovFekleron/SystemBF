<div class="container" style="max-width: 900px; margin: 0 auto; padding: 2rem 1rem;">
  <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: 2rem; color: var(--text);">
    Мой профиль
  </h1>

  <!-- Основная информация -->
  <div class="glass-card" style="padding: 2rem; margin-bottom: 2rem;">
    <div style="display: flex; gap: 2rem; align-items: start; margin-bottom: 2rem;">
      <!-- Аватар -->
      <div style="width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
        <span style="font-size: 3rem; font-weight: 700; color: white;">
          <%= @user.profile&.first_name&.first&.upcase || @user.first_name&.first&.upcase || @user.email.first.upcase %>
        </span>
      </div>

      <!-- Информация -->
      <div style="flex: 1;">
        <h2 style="font-size: 1.75rem; font-weight: 700; margin-bottom: 0.5rem;">
          <%= @user.profile&.full_name || @user.email %>
        </h2>

        <p style="color: var(--text-secondary); margin-bottom: 1rem;">
          <%= @user.email %>
        </p>

        <!-- Классификация -->
        <div style="display: inline-block; padding: 0.5rem 1rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); border-radius: 9999px; font-size: 0.875rem; font-weight: 600; color: white; margin-bottom: 1rem;">
          <%= t("user_classification.#{@user.classification}") %>
        </div>

        <div style="color: var(--text-secondary); font-size: 0.875rem;">
          Зарегистрирован <%= l(@user.created_at, format: :long) %>
        </div>
      </div>
    </div>

    <!-- Кнопка редактирования -->
    <button
      type="button"
      data-controller="profile-edit"
      data-action="click->profile-edit#toggleEdit"
      style="padding: 0.75rem 1.5rem; background: var(--surface); color: var(--text); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; font-weight: 500; cursor: pointer; transition: all 0.2s;"
    >
      ✏️ Редактировать профиль
    </button>
  </div>

  <!-- Форма редактирования (скрыта по умолчанию) -->
  <div
    data-profile-edit-target="form"
    style="display: none;"
  >
    <div class="glass-card" style="padding: 2rem;">
      <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1.5rem;">
        Редактирование профиля
      </h3>

      <%= form_with url: dashboard_profile_path, method: :patch, data: { profile_edit_target: "formElement" } do |form| %>
        <div style="display: grid; gap: 1.5rem;">
          <!-- Имя -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
              Имя
            </label>
            <%= form.text_field "profile[first_name]",
                value: @user.profile&.first_name || @user.first_name,
                style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem;" %>
          </div>

          <!-- Фамилия -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
              Фамилия
            </label>
            <%= form.text_field "profile[last_name]",
                value: @user.profile&.last_name || @user.last_name,
                style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem;" %>
          </div>

          <!-- Телефон -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
              Телефон
            </label>
            <%= form.text_field "profile[phone]",
                value: @user.profile&.phone,
                placeholder: "+7 (999) 123-45-67",
                style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem;" %>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <!-- Город -->
            <div>
              <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
                Город
              </label>
              <%= form.text_field "profile[city]",
                  value: @user.profile&.city,
                  placeholder: "Москва",
                  style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem;" %>
            </div>

            <!-- Страна -->
            <div>
              <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
                Страна
              </label>
              <%= form.text_field "profile[country]",
                  value: @user.profile&.country,
                  placeholder: "Россия",
                  style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem;" %>
            </div>
          </div>

          <!-- Дата рождения -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
              Дата рождения
            </label>
            <%= form.date_field "profile[birth_date]",
                value: @user.profile&.birth_date,
                style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem;" %>
          </div>

          <!-- О себе -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.875rem; font-weight: 500;">
              О себе
            </label>
            <%= form.text_area "profile[bio]",
                value: @user.profile&.bio,
                rows: 4,
                placeholder: "Расскажите немного о себе...",
                style: "width: 100%; padding: 0.75rem 1rem; background: var(--surface); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; color: var(--text); font-size: 1rem; resize: vertical;" %>
          </div>

          <!-- Кнопки -->
          <div style="display: flex; gap: 1rem;">
            <%= form.submit "Сохранить изменения",
                style: "flex: 1; padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease;" %>

            <button
              type="button"
              data-action="click->profile-edit#toggleEdit"
              style="padding: 0.75rem 1.5rem; background: var(--surface); color: var(--text); border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem; font-weight: 500; cursor: pointer; transition: all 0.2s;"
            >
              Отменить
            </button>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Дополнительная информация -->
  <div class="glass-card" style="padding: 2rem;">
    <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1.5rem;">
      Дополнительная информация
    </h3>

    <div style="display: grid; gap: 1rem;">
      <% if @user.profile&.phone.present? %>
        <div style="display: flex; justify-content: space-between; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.05);">
          <span style="color: var(--text-secondary);">Телефон:</span>
          <span style="font-weight: 500;"><%= @user.profile.phone %></span>
        </div>
      <% end %>

      <% if @user.profile&.city.present? || @user.profile&.country.present? %>
        <div style="display: flex; justify-content: space-between; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.05);">
          <span style="color: var(--text-secondary);">Местоположение:</span>
          <span style="font-weight: 500;">
            <%= [@user.profile&.city, @user.profile&.country].compact.join(', ') %>
          </span>
        </div>
      <% end %>

      <% if @user.profile&.birth_date.present? %>
        <div style="display: flex; justify-content: space-between; padding-bottom: 1rem; border-bottom: 1px solid rgba(255,255,255,0.05);">
          <span style="color: var(--text-secondary);">Дата рождения:</span>
          <span style="font-weight: 500;"><%= l(@user.profile.birth_date, format: :long) %></span>
        </div>
      <% end %>

      <% if @user.profile&.bio.present? %>
        <div>
          <div style="color: var(--text-secondary); margin-bottom: 0.5rem;">О себе:</div>
          <div style="padding: 1rem; background: var(--surface); border-radius: 0.5rem; line-height: 1.6;">
            <%= @user.profile.bio %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
