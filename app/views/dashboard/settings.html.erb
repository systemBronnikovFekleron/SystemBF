<% content_for :page_title, "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" %>
<% content_for :page_subtitle, "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞—à–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º–∏" %>

<div style="max-width: 800px;">
  <!-- Settings Sections -->

  <!-- 1. Email Preferences -->
  <div class="card fade-in" style="margin-bottom: var(--space-6);">
    <div style="border-bottom: 1px solid var(--gray-200); padding-bottom: var(--space-4); margin-bottom: var(--space-5);">
      <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-1);">
        üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ Email
      </h3>
      <p style="font-size: 0.875rem; color: var(--gray-600);">
        –£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ç–∏–ø–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç—å
      </p>
    </div>

    <div style="display: flex; flex-direction: column; gap: var(--space-4);">
      <!-- Email Toggle Item -->
      <% [
        { id: 'order_updates', label: '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤', description: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –∑–∞–∫–∞–∑–æ–≤ –∏ –æ–ø–ª–∞—Ç–µ' },
        { id: 'course_updates', label: '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤', description: '–ù–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —É—Ä–æ–∫–∏ –≤ –≤–∞—à–∏—Ö –∫—É—Ä—Å–∞—Ö' },
        { id: 'achievements', label: '–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è', description: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –Ω–∞–≥—Ä–∞–¥–∞—Ö –∏ —É—Ä–æ–≤–Ω—è—Ö' },
        { id: 'newsletter', label: '–ù–æ–≤–æ—Å—Ç–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞', description: '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –¥–∞–π–¥–∂–µ—Å—Ç –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –∞–∫—Ü–∏–π' },
        { id: 'marketing', label: '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –ø–∏—Å—å–º–∞', description: '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ —Å–∫–∏–¥–∫–∏' }
      ].each do |pref| %>
        <label style="display: flex; justify-content: space-between; align-items: center; cursor: pointer; padding: var(--space-3); border-radius: var(--radius-md); transition: background var(--transition-base);" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='transparent'">
          <div>
            <div style="font-weight: 500; color: var(--gray-900); margin-bottom: var(--space-1);">
              <%= pref[:label] %>
            </div>
            <div style="font-size: 0.8125rem; color: var(--gray-600);">
              <%= pref[:description] %>
            </div>
          </div>
          <div class="toggle-switch">
            <input type="checkbox" id="<%= pref[:id] %>" checked>
            <span class="toggle-slider"></span>
          </div>
        </label>
      <% end %>
    </div>
  </div>

  <!-- 2. Privacy Settings -->
  <div class="card fade-in" style="margin-bottom: var(--space-6);">
    <div style="border-bottom: 1px solid var(--gray-200); padding-bottom: var(--space-4); margin-bottom: var(--space-5);">
      <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-1);">
        üîí –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å (152-–§–ó)
      </h3>
      <p style="font-size: 0.875rem; color: var(--gray-600);">
        –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –∏ –¥–∞–Ω–Ω—ã—Ö
      </p>
    </div>

    <div style="display: flex; flex-direction: column; gap: var(--space-4);">
      <% [
        { id: 'profile_public', label: '–ü—É–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å', description: '–†–∞–∑—Ä–µ—à–∏—Ç—å –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤–∏–¥–µ—Ç—å –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å' },
        { id: 'show_achievements', label: '–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è', description: '–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≤–∞—à–∏ –Ω–∞–≥—Ä–∞–¥—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ' },
        { id: 'show_progress', label: '–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å', description: '–î–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –æ–±—É—á–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏' },
        { id: 'analytics', label: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞', description: '–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–±–æ—Ä –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞' }
      ].each do |pref| %>
        <label style="display: flex; justify-content: space-between; align-items: center; cursor: pointer; padding: var(--space-3); border-radius: var(--radius-md); transition: background var(--transition-base);" onmouseover="this.style.background='var(--gray-50)'" onmouseout="this.style.background='transparent'">
          <div>
            <div style="font-weight: 500; color: var(--gray-900); margin-bottom: var(--space-1);">
              <%= pref[:label] %>
            </div>
            <div style="font-size: 0.8125rem; color: var(--gray-600);">
              <%= pref[:description] %>
            </div>
          </div>
          <div class="toggle-switch">
            <input type="checkbox" id="<%= pref[:id] %>" <%= pref[:id] == 'analytics' ? 'checked' : '' %>>
            <span class="toggle-slider"></span>
          </div>
        </label>
      <% end %>
    </div>
  </div>

  <!-- 3. Language & Localization -->
  <div class="card fade-in" style="margin-bottom: var(--space-6);">
    <div style="border-bottom: 1px solid var(--gray-200); padding-bottom: var(--space-4); margin-bottom: var(--space-5);">
      <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-1);">
        üåê –Ø–∑—ã–∫ –∏ —Ä–µ–≥–∏–æ–Ω
      </h3>
      <p style="font-size: 0.875rem; color: var(--gray-600);">
        –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
      </p>
    </div>

    <div style="display: flex; flex-direction: column; gap: var(--space-5);">
      <!-- Language Select -->
      <div>
        <label style="display: block; font-weight: 500; color: var(--gray-900); margin-bottom: var(--space-2); font-size: 0.9375rem;">
          –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        </label>
        <select class="form-control" style="max-width: 300px;">
          <option value="ru" selected>üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
          <option value="en">üá¨üáß English</option>
        </select>
      </div>

      <!-- Timezone Select -->
      <div>
        <label style="display: block; font-weight: 500; color: var(--gray-900); margin-bottom: var(--space-2); font-size: 0.9375rem;">
          –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
        </label>
        <select class="form-control" style="max-width: 300px;">
          <option value="Europe/Moscow" selected>–ú–æ—Å–∫–≤–∞ (UTC+3)</option>
          <option value="Europe/Samara">–°–∞–º–∞—Ä–∞ (UTC+4)</option>
          <option value="Asia/Yekaterinburg">–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ (UTC+5)</option>
          <option value="Asia/Omsk">–û–º—Å–∫ (UTC+6)</option>
        </select>
      </div>
    </div>
  </div>

  <!-- 4. Security -->
  <div class="card fade-in" style="margin-bottom: var(--space-6);">
    <div style="border-bottom: 1px solid var(--gray-200); padding-bottom: var(--space-4); margin-bottom: var(--space-5);">
      <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-1);">
        üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
      </h3>
      <p style="font-size: 0.875rem; color: var(--gray-600);">
        –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–º –∏ –¥–æ—Å—Ç—É–ø–æ–º –∫ –∞–∫–∫–∞—É–Ω—Ç—É
      </p>
    </div>

    <div style="display: flex; flex-direction: column; gap: var(--space-3);">
      <a href="/password-reset" class="btn btn-outline" style="text-align: left; display: flex; justify-content: space-between; align-items: center;">
        <span>–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</span>
        <span>‚Üí</span>
      </a>

      <a href="/dashboard/sessions" class="btn btn-outline" style="text-align: left; display: flex; justify-content: space-between; align-items: center;">
        <span>–ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏</span>
        <span style="padding: 2px 8px; background: rgba(79, 70, 229, 0.1); color: var(--primary-dark); border-radius: var(--radius-sm); font-size: 0.75rem; font-weight: 600;">2 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</span>
      </a>
    </div>
  </div>

  <!-- 5. Danger Zone -->
  <div class="card fade-in" style="border: 1px solid var(--red-200); background: linear-gradient(to bottom, white, rgba(239, 68, 68, 0.02));">
    <div style="border-bottom: 1px solid var(--red-200); padding-bottom: var(--space-4); margin-bottom: var(--space-5);">
      <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--red-600); margin-bottom: var(--space-1);">
        ‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞
      </h3>
      <p style="font-size: 0.875rem; color: var(--gray-600);">
        –ù–µ–æ–±—Ä–∞—Ç–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –≤–∞—à–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º
      </p>
    </div>

    <div>
      <button class="btn" style="background: var(--red-600); color: white; width: 100%;" onclick="confirmDeleteAccount()">
        –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
      </button>
      <p style="font-size: 0.75rem; color: var(--gray-500); margin-top: var(--space-2); text-align: center;">
        –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.
      </p>
    </div>
  </div>

  <!-- Save Button -->
  <div style="margin-top: var(--space-8); text-align: center;">
    <button class="btn btn-primary" style="padding: var(--space-3) var(--space-10);" onclick="saveSettings()">
      –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
    </button>
  </div>
</div>

<style>
  /* Toggle Switch */
  .toggle-switch {
    position: relative;
    width: 48px;
    height: 24px;
  }

  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--gray-300);
    transition: 0.3s;
    border-radius: 24px;
  }

  .toggle-slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background: white;
    transition: 0.3s;
    border-radius: 50%;
  }

  input:checked + .toggle-slider {
    background: var(--primary);
  }

  input:checked + .toggle-slider:before {
    transform: translateX(24px);
  }

  .form-control {
    width: 100%;
    padding: var(--space-3);
    border: 1px solid var(--gray-300);
    border-radius: var(--radius-md);
    font-size: 0.9375rem;
    transition: all var(--transition-base);
  }

  .form-control:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
</style>

<script>
  function saveSettings() {
    // TODO: Implement actual save via AJAX
    alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã! (–§—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ)');
  }

  function confirmDeleteAccount() {
    const confirmed = confirm(
      '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç?\n\n' +
      '–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, –≤–∫–ª—é—á–∞—è:\n' +
      '- –ü—Ä–æ—Ñ–∏–ª—å\n' +
      '- –ó–∞–∫–∞–∑—ã\n' +
      '- –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è\n' +
      '- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è\n' +
      '\n–±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.'
    );

    if (confirmed) {
      const doubleCheck = confirm('–≠—Ç–æ –û–ö–û–ù–ß–ê–¢–ï–õ–¨–ù–û–ï –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?');
      if (doubleCheck) {
        // TODO: Implement actual account deletion
        alert('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
      }
    }
  }
</script>
